<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Desktop</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto&display=swap"
      rel="stylesheet"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="normalize.css" />
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
      <div class="page-wrapper">
        <div class="main-content">
          <div class="main-content__row">
            <div class="article content-wrapper">
              <div class="article__head">
                <h1 class="article__head__title">
                  Torrents: block or allow?
                </h1>
              </div>
              <div class="article-body">
                <div class="article-body__content">
                  <article>
                    <p>
                      Our pilot projects demonstrated that at 44 percent of
                      companies, employees use peer-to-peer networks for data
                      transfer, such as downloading torrents. This places an
                      extra burden on the network and consumes bandwidth. But
                      there's another risk. Malware may be lurking on torrent
                      trackers, posing as various software, movies, and other
                      files. A tempting torrent may lead to a ransomware attack
                      or deliver the malware of professional cybercriminals. For
                      instance, torrents were used to distribute<a href="https://securityboulevard.com/2019/10/ransomware-statistics-for-2019-q2-to-q3-report/" target="_blank" class="article__body__link"> STOP<a/> ransomware
                      and the APT37 group weaponized a YouTube video downloader
                      app with the <a href="https://www2.fireeye.com/rs/848-DID-242/images/rpt_APT37.pdf" target="_blank" class="article__body__link"> KARAE</a> backdoor and distributed it on torrent
                      websites.
                    </p>
                    <div class="recommendations">
                      <h2>Recommendations</h2>
                      <p>
                        Introduce a company-wide ban on BitTorrent data
                        transfers. Implement a whitelist policy with AppLocker.
                      </p>
                    </div>
                    <p>
                      Cybersecurity must be more than just the perimeter and
                      traditional security tools. Our research indicates that 92
                      percent of threats are detected when the enemy is already
                      inside.
                    </p>
                    <p>
                      Cybergroups breach the security on the perimeter of their
                      targets. This is evident from the <a href="https://www.ptsecurity.com/ww-en/analytics/cybersecurity-threatscape-2018-q3/" target="_self" class="article__body__link">growing percentage of
                      successful targeted attacks<a/>. This is a good reason to
                      shift attention from prevention of attacks on the
                      perimeter to timely detection and response inside the
                      network. However, it is hard to detect a well-planned
                      cyberattack, especially when it is extended over time.
                      Attackers are no longer hindered by antivirus software.
                      They constantly modify source code, use bodyless malware,
                      and exploit zero-day vulnerabilities. Dynamic analysis is
                      no cure-all, either. Attackers have <a href="https://attack.mitre.org/techniques/T1497/" target="_blank" class="article__body__link">learned to bypass</a> the
                      virtualization technologies typically used in sandboxes.
                      And we cannot rule out the possibility that attackers can
                      get by without any malware at all, just using the tools
                      permitted by the target's security policies.
                    </p>
                    <p>
                      However, attackers leave traces in network traffic, so
                      it's up to cybersecurity specialists to find those traces.
                      Our pilot projects have demonstrated that NTA solutions
                      are effective at detecting threats on the internal
                      network, ranging from non-compliance with IS policies to
                      complex targeted attacks.
                    </p>
                    <table align="center">
                      <tr>
                        <th>Module
                            name</th>
                        <th>ID</th>
                        <th>Compilation time</th>
                      </tr>
                        <tr>
                          <td>Root</td>

                          <td>5E6909BA</td>

                          <td>GMT: Wednesday, 11 March 2020, 15:54:34</td>
                        </tr>
                        <tr>
                          <td>Plugins</td>
                          <td>5E69097C</td>
                          <td>GMT: Wednesday, 11 March 2020, 15:53:32</td>
                        </tr>
                        <tr>
                          <td>Online</td>
                          <td>5E690988</td>
                          <td>GMT: Wednesday, 11 March 2020, 15:53:44</td>
                        </tr>
                      <tr>
                        <td>Config</td>
                        <td>5E690982</td>
<td>GMT: Wednesday, 11 March 2020, 15:53:38</td>
                      </tr>
                      <tr>
                        <td>Install</td>
                        <td>5E69099F</td>
                        <td>GMT: Wednesday, 11 March 2020, 15:54:07</td>
                      </tr>
                      <tr>
                        <td>DNS</td>
                        <td>5E690909</td>
                        <td>
                            GMT: Wednesday, 11 March 2020, 15:51:37
                        </td>
                      </tr>
                    </table>
                    <p>
                      The identifiers of these modules remain unchanged from
                      version to version; they, too, are installed and run in a
                      separate thread via the registry. Module compilation times
                      can be found in the auxiliary header that comes before the
                      shellcode.
                    </p>
                    <figure>
                      <img
                        src="/upload/images/figure46.png"
                        class="article_img"
                      />
                      <figcaption>
                        Figure 46. Location of the compilation time in the
                        shellcode header
                      </figcaption>
                    </figure>
                    <div class="article__encryption">
                      <p>
                        A typical feature of any copy of ShadowPad is encryption
                        of the strings in each module. The encryption algorithm
                        is similar to the one used for backdoor decryption. The
                        only difference is in the constants used for key
                        modification. The method of calling some API functions
                        in ShadowPad modules is somewhat interesting. Some
                        copies of the malware calculate the function address for
                        each time a function is called, as shown in Figure 47.
                        In addition, addresses of the functions to be called can
                        be obtained via a special structure. Loading addresses
                        for libraries are obtained based on the values of the
                        structure members, to which the offsets of the required
                        API functions are then added.
                      </p>
                      <div class="article__encryption__images">
                        <figure>
                        <img
                          src="/upload/images/figure47.png"
                          class="article__encryption__img"
                        />
                        <figcaption>Figure 47. String decryption code in ShadowPad</figcaption>
                        </figure>
                        <figure>
                        <img src="/upload/images/figure48.png" class="article__encryption__img" />
                        <figcaption>
                            Figure 48. Example of obfuscation of calling an API function
                        </figcaption>
                        </figure>
                      </div>
                    </div>
                    <div class="article__introduction">
                      <h2 class="article__introduction__heading">
                        Introduction
                      </h2>
                      <p>
                        During threat research in March 2020,1 PT Expert
                        Security Center specialists found a previously unknown
                        backdoor and named it xDll, based on the original name
                        found in the code. As a result of a configuration flaw
                        of the malware's command and control (C2) server, some
                        server directories were externally accessible. The
                        following new samples were found on the server:
                      </p>
                      <div class="article__introduction__list">
                      <ul>
                        <li>ShadowPad</li>
                        <li>A previously unknown Python backdoor</li>
                        <li>Utility for progressing the attack</li>
                        <li>Encrypted xDII backdoor</li>
                      </ul>
                    </div>
                      <p>
                        ShadowPad is used by Winnti (APT41, BARIUM, AXIOM), a
                        group that has been active since at least 2012. This
                        state-sponsored group originates from China.2 The key
                        interests of the group are espionage and financial gain.
                        Their core toolkit consists of malware of their own
                        making. Winnti uses complex attack methods, including
                        supply chain and watering hole attacks. The group knows
                        exactly who their victims are. They develop attacks very
                        carefully and deploy their primary tools only after
                        detailed reconnaissance of the infected system. The
                        group attacks countries all over the world: Russia, the
                        United States, Japan, South Korea, Germany, Mongolia,
                        Belarus, India, and Brazil. The group tends to attack
                        the following industries:
                      </p>
                      <ul>
                        <li>Gaming</li>
                        <li>Software development</li>
                        <li>Aerospace</li>
                        <li>Energy</li>
                        <li>Pharmaceuticals</li>
                        <li>Finance</li>
                        <li>Telecom</li>
                        <li>Construction</li>
                        <li>Education</li>
                      </ul>
                      <p>
                        The first attack with ShadowPad was recorded in 2017.3 This backdoor has been
often used in supply chain attacks such as the CCleaner4 and ASUS5 hacks. ESET
released its most recent report about Winnti activities involving ShadowPad in
January 2020.6 We didn't find any connection with the current infrastructure.
However, during research we found that the new ShadowPad infrastructure had
commonalities with infrastructures of other groups, which may mean that Winnti
was involved in other attacks with previously unknown organizers and perpetrators.
                      </p>
                      <p>
                        This report contains a detailed analysis of the new network infrastructure related
to ShadowPad, new samples of malware from the Winnti group, and also analysis
of ties to other attacks possibly associated with the group.
                      </p>
                    </div>
                  </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
<div class="article__line"></div>
<ol>
  <li><a href="https://twitter.com/Vishnyak0v/status/1239908264831311872" target="_blank">https://twitter.com/Vishnyak0v/status/1239908264831311872</a></li>
  <li> <a href="https://securelist.com/winnti-more-than-just-a-game/37029/" target="_blank">https://securelist.com/winnti-more-than-just-a-game/37029/
  </a></li>
  <li> <a  href="https://securelist.com/shadowpad-in-corporate-networks/81432/" target="_blank">https://securelist.com/shadowpad-in-corporate-networks/81432/</a></li>
  <li> <a href="https://securelist.com/shadowpad-in-corporate-networks/81432/" target="_blank">https://securelist.com/shadowpad-in-corporate-networks/81432/</a></li>
<li><a href=https://securelist.com/operation-shadowhammer-a-high-profile-supply-chain-attack/90380/" target="_blank">https://securelist.com/operation-shadowhammer-a-high-profile-supply-chain-attack/90380/</a></li>
<li><a href="https://www.welivesecurity.com/2020/01/31/winnti-group-targeting-universities-hong-kong/" target="_blank">https://www.welivesecurity.com/2020/01/31/winnti-group-targeting-universities-hong-kong/<a/></li>
</ol>

    </article>
  </body>
</html>
